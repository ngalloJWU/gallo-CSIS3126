<% layout('/partials/boilerplate')%>
<div class="d-flex flex-column m-5">
    <div class="d-flex">
        <div>
            <img style="width:500px; height: 500px;"src="<%=product.images[0].url%>">
        </div>
        <div class="d-flex flex-column m-3 w-75">
            <h1><%=product.productTitle%>
                <%if(currentUser){%>
                    <%if(product.savedBy.includes(currentUser._id)){%>
                        <i class="fa-solid fa-bookmark" id="savePost"></i>
                    <%}else{%>
                        <i class="fa-regular fa-bookmark" id="savePost"></i>
                    <%}%>
                <% } %> 
            </h1>
            <h2>$<%=product.productPrice%></h2>
            <p><%=product.locationName%></p>
            <i>Posted by: <%=product.author.username%></i>
            <div id="map" style='width: 100%; height: 300px;'></div>
            <div class="d-flex w-100">
                <button type="button" class="btn btn-outline-success w-100 m-2">Interested</button>
            </div>
        </div>
    </div>
    <h2>Description</h2>
    <p><%=product.productDescription%></p>
    <br>
    <h2>Related Items</h2>
    <div class="d-flex flex-row">
        <%for(let relProduct of relatedProducts){%>
            <a href="/products/<%=relProduct._id%>/show">
                <div class="d-flex flex-column align-items-center m-3">
                    <img class="productImg"src="<%=relProduct.images[0].url%>">
                    <p><%=relProduct.productTitle%></p> 
                </div>
            </a>
        <%}%>
    </div>
</div>
<% if(currentUser){%>
    <script>
    let user='<%-currentUser._id%>';
    let product = '<%-product._id%>';
    document.getElementById('savePost').addEventListener('click',function (){
        console.log('alert')
        addSave(user,product);
    })
    </script>
<%}%>
<%-include('../partials/mapScript')%>